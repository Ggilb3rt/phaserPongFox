<!DOCTYPE html>
<html>
<head>
    <script src="./dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

    <script>
    globalWidth = 928
    globalHeight = 793
    var config = {
        type: Phaser.AUTO,
        width: globalWidth,
        height: globalHeight,
        physics: {
        default: 'arcade',
        arcade: {
            gravity: { y: 300 },
            debug: false
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var game = new Phaser.Game(config);

    function preload ()
    {
        this.load.setBaseURL('game/');

        this.load.image('sky', 'assets/sky.png');
        this.load.image('grass1', 'assets/grass1.png');
        this.load.image('grass2', 'assets/grass2.png');
        this.load.image('tree1', 'assets/tree1.png');
        this.load.image('tree2', 'assets/tree2.png');
        this.load.image('tree3', 'assets/tree3.png');
        this.load.image('tree_head', 'assets/tree_head.png');
        this.load.image('tree_head_plat', 'assets/tree_headplatform.png');
        this.load.image('grass_plat', 'assets/grass1platform.png');
        this.load.spritesheet('dude', 'assets/WizardPack/Idle.png', {
            frameWidth: 1386/6, frameHeight: 86
        });
        this.load.spritesheet('dudeRun', 'assets/WizardPack/Run.png', {
            frameWidth: 1848/8, frameHeight: 86
        });
        this.load.spritesheet('dudeJump', 'assets/WizardPack/Jump.png', {
            frameWidth: 462/2, frameHeight: 89
        });
    }

    function create ()
    {
        // Add Bg etc
        this.add.image(globalWidth/2, globalHeight/2, 'sky')
        // this.add.image(globalWidth/2, globalHeight/2, 'grass1')
        // this.add.image(globalWidth/2, globalHeight/2, 'tree1')
        // this.add.image(globalWidth/2, globalHeight/2, 'tree2')
        // this.add.image(globalWidth/2, globalHeight/2, 'tree3')
        // this.add.image(globalWidth/2, globalHeight/2, 'tree_head')
        

        // Create platforms
        platforms = this.physics.add.staticGroup();
        
        platforms.create(globalWidth/2, globalHeight/2, 'grass_plat');
        platforms.create(450, globalHeight - 33, 'grass_plat').setScale(1).refreshBody();
        // platforms.create(150, 250, 'tree_head_plat');
        // platforms.create(750, 220, 'grass1');

        this.add.image(globalWidth/2, globalHeight/2, 'grass2')



        // Create player
        player = this.physics.add.sprite(200, 100, 'dude');

        // player.setBounce(0.2);
        player.setCollideWorldBounds(true);
        player.body.setGravityY(500)
        
        this.anims.create({
            key: 'idle',
            frames: this.anims.generateFrameNumbers('dude', { start: 0, end: 5 }),
            frameRate: 6,
            repeat: -1
        });

        this.anims.create({
            key: 'run',
            frames: this.anims.generateFrameNumbers('dudeRun', { start: 0, end: 7 }),
            frameRate: 8,
            repeat: -1
        });

        this.anims.create({
            key: 'jump',
            frames: this.anims.generateFrameNumbers('dudeJump', { start: 0, end: 1 }),
            frameRate: 2,
            repeat: -1
        });
        
        this.physics.add.collider(player, platforms);


        player.anims.play('idle');


    }

    function update ()
    {
        // keyboard handler
        cursors = this.input.keyboard.createCursorKeys();
        if (cursors.left.isDown)
        {
            player.setVelocityX(-160);
            player.anims.play('run', true);
        }
        else if (cursors.right.isDown)
        {
            player.setVelocityX(160);
            player.anims.play('run', true);
        }
        else
        {
            player.setVelocityX(0);
            player.anims.play('idle', true);
        }

        if (cursors.up.isDown && player.body.touching.down)
        {
            player.setVelocityY(-330);
        }
        
        if (!player.body.touching.down)
            player.anims.play('jump', true);
    }
    </script>

</body>
</html>